# Хлебер-β

![Логотип Хлебер-β](./app/static/img/icon.png)

**Хлебер-β** (_хлебер-бетта_) - это приложение от студентов _Яндекс.Лицея_, созданное помочь людям, которые в период пандемии не могут самостоятельно выбраться на улицу и купить необходимые продукты и лекарства.
Для решения проблемы мы создали систему, связывающую нуждающихся людей с людьми, желающими им помочь.

**Хлебер-β** состоит из двух частей:
- Веб-сайт, на котором пользователь может зарегестрироваться как "клиент", чтобы оставить заказ, или как "волонтёр", чтобы получить удобные инструменты для исполнения этих закозов, например карта ближайших к дому клиента магазинов.
- Бот _ВКонтакте_, оповещающий клиентов и волонтёров об изменениях, связанных с их заказами.

## Создание локальной копии приложения

### Установка

- Сохраните копию ветки _master_ на компьютер.

- Создайте виртуальное окружение _Python_ и установите зависимости из `requirements.txt`.

- Сохраните в папке с репозиторием файл конфигурации `.env`:

```
VK_TOKEN=<токен группы>
VK_GROUP_ID=<id группы>
```

- Запустите создание таблиц в БД:

```cmd
> flask db upgrade
```

### Запуск

- Запустите _Flask_-приложение.
    - Вы можете просто запустить `wsgi.py` как _Python_-скрипт (_рекомендовано для быстрой отладки_);
    - Либо запустить его с помощью `gunicorn` или любого другого _WSGI_-сервера (_рекомендовано для стабильной работы_):

```cmd
> gunicorn -b 0.0.0.0:8000 wsgi:app
```

- Параллельно запустите бота _ВКонтакте_ запуском `vk.py` в качестве _Python_-скрипта.

### Обновление

- Загрузите на компьютер обновлённую ветку _master_.

- Обновите структуру таблиц в БД:

```cmd
> flask db upgrade
```

## Структура проекта

- `/app/` - модуль веб-сайта.
    - `/app/static/` - директория для статичных файлов.
    - `/app/templates/` - шаблоны веб-страниц (_Jinja2_).
- `/migrations/` - служебные файлы _alembic_.
- `/.env` - файл конфигурации, параметры из которого загружаются в переменные среды.
- `/Procfile` - файл, задающий процессы для запуска на сервере _Heroku_.
- `/requirements.txt` - файл с зависимостями проекта.

Описание ко всем неупомянутым файлам находится в их собственной документации.

## Используемые технологии

- _Heroku_ - хостинг всего веб-приложения, включая БД.
- _Flask_ - микро-фреймворк, используемый для создания веб-сайта.
- _SQLAlchemy*_ - библиотека ORM для доступа к БД.
    - _Alembic*_ - библиотека, позволяющая вносить правки в БД без потери данных.
- _WTForms*_ - библиотека для задания HTML-форм с помощью ООП.
- _Flask-Login_ - дополнение к Flask для удобной авторизации пользователей.
- _API Яндекс.Карт (в частности StaticAPI и Geocoder)_ - API рендера карт на странице и поиска объектов по адресу.
- _Bootstrap_ - CSS-фреймворк, отвечающий за всю красоту на нашем веб-сайте.
- _vk-api (python273)_ - библиотека для создания приложений на основе VK API.

_Модули, помеченые звёздочкой, подключены к Flask с помощью специальных дополнений._
